# Package Base
[![Build Status](https://api.travis-ci.org/WsdlToPhp/PackageBase.svg)](https://travis-ci.org/WsdlToPhp/PackageBase)
[![Scrutinizer Code Quality](https://scrutinizer-ci.com/g/WsdlToPhp/PackageBase/badges/quality-score.png)](https://scrutinizer-ci.com/g/WsdlToPhp/PackageBase/)
[![Code Coverage](https://scrutinizer-ci.com/g/WsdlToPhp/PackageBase/badges/coverage.png)](https://scrutinizer-ci.com/g/WsdlToPhp/PackageBase/)
[![Dependency Status](https://www.versioneye.com/user/projects/5571b32b6634650018000011/badge.svg)](https://www.versioneye.com/user/projects/5571b32b6634650018000011)

## Main features
This project contains base classes used as parent class by the generated classes from [PackageGenerator](https://github.com/WsdlToPhp/PackageGenerator).

## How to

### AbstractStructBase
#### Description
This class if the base class for any ```StructType``` class generated by [PackageGenerator](https://github.com/WsdlToPhp/PackageGenerator).
It defines three methods:
- __set_state($array): Usefull when you load the string representation of an object that you stored using ```var_export```. It also allows you to ease the instanciation of an object that contains many properties which would be hard to instanciate using the __construct method. You can see ```__set_state``` as an hydratation method.
- _set($name, $value): As magic method ```__set``` but used by the ```__set_state``` method. Plus, defining ```__set``` method on used class by the classmap option for the SoapClient breaks the correct hydratation of your received objects.
- _get($name): As magic method ```__get```. Used by ```AbstractStructArrayBase``` class
####Usage
```php
    $item = \Api\StructType\Item::__set_state(array(
        'id' => 1,
        'name' => 'Entity #1',
        'label' => 'Entity #1',
        '_href' => 'http://www.entity.com',
    ));
    // $item is now an \Api\StructType\Item object
```

### AbstractStructArrayBase
####Description
This class if the base class for any ```ArrayType``` class generated by [PackageGenerator](https://github.com/WsdlToPhp/PackageGenerator).
Its goal is to provide utility/handful methods by implementing ```ArrayAccess```, ```Iterator``` and ```Countable``` PHP interfaces.
#### Usage
As soon as you have an element that is an array of items such as:
```php
    $items = \Api\ArrayType\Items::__set_state(array(
        'items' => array(
            \Api\StructType\Item::__set_state(array(
                'id' => 1,
                'name' => 'Entity #1',
                'label' => 'Entity #1',
                '_href' => 'http://www.entity-1.com',
            ),
            \Api\StructType\Item::__set_state(array(
                'id' => 2,
                'name' => 'Entity #2',
                'label' => 'Entity #2',
                '_href' => 'http://www.entity-2.com',
            ),
            \Api\StructType\Item::__set_state(array(
                'id' => 3,
                'name' => 'Entity #3',
                'label' => 'Entity #3',
                '_href' => 'http://www.entity-3.com',
            ),
        )
    ));
    // 'items' is the unique property of the object
    // Its name is returned by the getAttributeName method
    // defined in the generated \Api\ArrayType\Items class
```
- call first ```initInternArray``` method on your ArrayType object such as:
```php
    $items->initInternArray();
```
- then you can call ``count```, ```length``` methods: gives you the number of items contained by your object
- or you can iterate through the items:
```php
    foreach ($items as $item) {
        // $item is an \Api\StructType\Item object
    }
```

## Need improvements for these classes?
Feel free to make some pull requests. We'll study them and let you know when it can be integrated.

## Unit tests
You can run the unit tests with the following command:
```
    $ cd /path/to/src/WsdlToPhp/PackageBase/
    $ composer install
    $ phpunit
```